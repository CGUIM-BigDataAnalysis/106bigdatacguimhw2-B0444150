chart1
chart1<-ggplot()+
geom_bar(data=Result%>%head(100),
aes(x=國別,y=總人數),
stat="identity")+theme(axis.text.x = element_text(angle = 80, hjust = 1,vjust = 1))
chart1
chart1<-ggplot()+
geom_bar(data=Result%>%head(100),
aes(x=國別,y=總人數),
stat="identity")
chart1
chart1<-ggplot()+
geom_bar(data=Result%>%head(100),
aes(x=國別,y=總人數),
stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 1))
chart1
chart1<-ggplot()+
geom_bar(data=Result%>%head(50),
aes(x=國別,y=總人數),
stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 1))
chart1
chart1<-ggplot()+
geom_bar(data=Result%>%head(50),
aes(x=國別,y=總人數),
stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0))
chart1
chart1<-ggplot()+
geom_bar(data=Result%>%head(50),
aes(x=國別,y=總人數),
stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
chart1
View(college103)
student <- read.csv("C:/Users/user/Desktop/student.csv", encoding="BIG-5", header=FALSE, row.names=1, stringsAsFactors=FALSE)
View(student)
student <- read.csv("C:/Users/user/Desktop/student.csv", encoding="BIG-5", header=FALSE, row.names=1, stringsAsFactors=FALSE)
student <- read.csv("C:/Users/user/Desktop/student.csv", header=FALSE)
View(student)
colnames<-student[1,]
View(colnames)
student <- read.csv("C:/Users/user/Desktop/student.csv", header=FALSE,stringsAsFactors = F)
View(student)
colnames(student)<-c(student[,1])
c(student[,1])
c(student[1,])
colnames(student)<-c(student[1,])
student<--student[1,]
student<-student[-1,]
student2<-student%>%
filter(學年度=103|104|105)
student2<-student%>%
filter(學年度==103|104|105)
View(student2)
student2<-student%>%
filter(學年度=="103"|"104"|"105")
student2<-student%>%
filter(學年度=="103|104|105")
student2<-student%>%
filter(學年度=="103"|學年度=="104"|學年度=="105")
student2<-student%>%
filter(學年度=="103"|學年度=="104"|學年度=="105"|學年度=="106")
tail(student2)
student2<-student%>%
filter(學年度=="103"|學年度=="104")
Q4_1<-student2%>%
group_by("對方學校國別")%>%
arrange(desc(出國學生人數))
View(Q4_1)
Q4_1<-student2%>%
group_by("對方學校國別")
View(Q4_1)
Q4_1<-student2%>%
group_by(對方學校國別)%>%
arrange(desc(出國學生人數))
View(Q4_1)
View(Q4_1)
Q4_1<-student2%>%
group_by(對方學校國別)
student2<-student%>%
filter(學年度=="103"|學年度=="104")
Q4_1<-student2%>%
group_by(對方學校國別)
Q4_1<-student2%>%
group_by(對方學校國別)%>%
summarise(總人數=sum(出國學生人數))%>%
arrange(desc(出國學生人數))
class(Q4_1$出國學生人數)
Q4_1<-student2%>%
group_by(對方學校國別)%>%
summarise(總人數=sum(as.numeric(出國學生人數)))%>%
arrange(desc(出國學生人數))
student2$出國學生人數<-as.numeric(student2$出國學生人數)
Q4_1<-student2%>%
group_by(對方學校國別)%>%
summarise(總人數=sum(出國學生人數))%>%
arrange(desc(出國學生人數))
Q4_1<-student2%>%
group_by(對方學校國別)%>%
arrange(desc(出國學生人數))
View(Q4_1)
Q4_1<-student2%>%
group_by("對方學校國別")%>%
arrange(desc(出國學生人數))
View(Q4_1)
Q4_1<-student2%>%
arrange(desc(出國學生人數))
View(Q4_1)
arrange(desc(出國學生人數))
arrange(desc(出國學生人數))
student2$出國學生人數<-as.numeric(student2$出國學生人數)
Q4_1<-student2%>%
select("對方學校國別","出國學生人數")
Q4_1<-student2%>%
select("對方學校國別","出國學生人數")%>%
arrange(desc(出國學生人數))
Q4_1<-student2%>%
select("對方學校國別","出國學生人數")%>%
arrange(desc(出國學生人數))%>%
head(10)
Q4_1<-student2%>%
arrange(desc(出國學生人數))%>%
head(10)
Q4_1<-student2%>%
group_by(對方學校國別)%>%
arrange(desc(出國學生人數))%>%
head(10)
Q4_1<-student2%>%
group_by(對方學校國別)%>%
summarise(人數=n())%>%
arrange(desc(出國學生人數))%>%
head(10)
Q4_1<-student2%>%
arrange(desc(出國學生人數))%>%
group_by(對方學校國別)
View(Q4_1)
Q4_1<-student2%>%
group_by(對方學校國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
View(Q4_1)
group_by(對方學校國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
group_by(對方學校國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
Q4_1<-student2%>%
select(學校名稱)%>%
group_by(對方學校國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
Q4_1<-student2%>%
select(學校名稱,對方學校國別)%>%
group_by(對方學校國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
View(Q4_1)
Q4_1<-student2%>%
select(學校名稱,對方學校國別)
View(Q4_1)
Q4_1<-student2%>%
select(學校名稱,對方學校國別)%>%
group_by(對方學校國別)
Q4_1<-student2%>%
select(學校名稱,對方學校國別)%>%
group_by(對方學校國別)%>%
summarise(學生人數=sum(出國學生人數))
student2$出國學生人數<-as.numeric(student2$出國學生人數)
Q4_1<-student2%>%
select(學校名稱,對方學校國別)%>%
group_by(對方學校國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
Q4_1<-student2%>%
group_by(對方學校國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
View(Q4_1)
Q4_1<-student2%>%
group_by(學年度,ㄝ對方學校國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
Q4_1<-student2%>%
group_by(學年度,對方學校國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
Q4_1<-student2%>%
group_by(學校名稱,對方學校國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
Q4_1<-student2%>%
group_by(對方學校國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
Q4_1%>%head(10)
Q4_2<-student2%>%
group_by(學校名稱)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
View(Q4_2)
Q4_2%>%head(10)
View(Q4_1)
library(ggplot2)
chart5<-ggplot()+
geom_bar(data=Q4_1,
aes(x=對方學校國別,y=學生人數),
stat="identity")
chart5
chart5<-ggplot()+
geom_bar(data=Q4_1,
aes(x=對方學校國別,y=學生人數),
stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
chart5
library(choroplethr)
ggmap(map)
library(ggmap)
library(mapproj)
map <- get_map(location = 'China', zoom = 7)
ggmap(map)
map <- get_map(location = 'China', zoom = 2)
ggmap(map)
map <- get_map(location = 'China', zoom = 5)
ggmap(map)
View(Result)
world_map <- map_data("world")
world_map
library(readr)
X105 <- read_csv("C:/Users/user/Downloads/105.csv")
View(X105)
x105<-x105[,-4:6]
X105<-X105[,-4:6]
X105<-X105[,-(4:6)]
Data7<-X105%>%arrange(總人數)
View(Data7)
Data7<-X105%>%arrange(desc(總人數))
View(Data7)
View(Result)
View(DataFinal1)
View(Result)
View(DataFinal)
View(Result)
View(Result2)
View(Result)
View(Result2)
View(Data1_1)
View(DataFinal)
View(Q4_1)
library(ggplot2)
View(Result)
ggplot(Result,aes(x=國別,y=總人數))+
geom_point()+
geom_smooth(method='lm')
ggplot(Result,aes(x=國別,y=總人數))+
geom_point()
ggplot(Result,aes(x=國別,y=總人數))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
View(Result)
ggplot(Result%>%head(10),aes(x=國別,y=總人數))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
compare<-cbind(Result,Q4_1)
View(compare)
compare<-data.frame(來台國家=Result$國別,
來台學生=Result$總人數)
compare<-data.frame(來台國家=Result$國別,
來台學生=Result$總人數,
留學國家=Q4_1$對方學校國別,
留學人數=Q4_1$學生人數)
View(compare)
View(compare)
Compare<-data.frame(來台國家=Result$國別,
來台學生=Result$總人數,
留學國家=Q4_1$對方學校國別,
留學人數=Q4_1$學生人數)
View(compare)
compare<-full_join(Result,Q4_1)
compare<-full_join(Result,Q4_1,by=國別)
compare<-cbind(Result,Q4_1)
Compare<-data.frame(來台國家=Result$國別,
來台學生=Result$總人數,
留學國家=Q4_1$對方學校國別,
留學人數=Q4_1$學生人數)
Compare<-data.frame(來台國家=Result$國別,
來台學生=Result$總人數,
留學國家=Q4_1$對方學校國別,
留學人數=Q4_1$學生人數)
Compare<-data.frame(來台國家=Result$國別,
來台學生=Result$總人數,
留學國家=Q4_1$對方學校國別,
留學人數=Q4_1$學生人數,StringAsFactor=F)
group_by(國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
Q4_1<-student2%>%
rename(國別=對方學校國別)%>%
group_by(國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
View(Q4_1)
campare<-full_join(Result,Q4_1,by=國別)
campare<-full_join(Result,Q4_1,by="國別")
View(campare)
compare<-compare%>%
rename(來台學生=總人數,
留學人數=學生人數)
compare<-full_join(Result,Q4_1,by="國別")
class(compare)
compare<-compare%>%
rename("來台學生人數"=總人數,
"留學人數"=學生人數)
View(compare)
Result%>%head(10)
library(readr)
school103 <- read_csv("http://stats.moe.gov.tw/files/detail/103/103_ab103_C.csv")
school104 <- read_csv("http://stats.moe.gov.tw/files/detail/104/104_ab104_C.csv")
school105 <- read_csv("http://stats.moe.gov.tw/files/detail/105/105_ab105_C.csv")
school106 <- read_csv("http://stats.moe.gov.tw/files/detail/106/106_ab105_C.csv")
Data1<-rbind(school103,school104)
Data2<-rbind(school105,school106)
Data2<-Data2%>%
rename("學位生-正式修讀學位外國生"="學位生_正式修讀學位外國生",
"學位生-僑生(含港澳)"="學位生_僑生(含港澳)",
"學位生-正式修讀學位陸生"="學位生_正式修讀學位陸生",
"非學位生-外國交換生" ="非學位生_外國交換生",
"非學位生-外國短期研習及個人選讀"="非學位生_外國短期研習及個人選讀",
"非學位生-大專附設華語文中心學生"="非學位生_大專附設華語文中心學生",
"非學位生-大陸研修生"="非學位生_大陸研修生",
"非學位生-海青班"="非學位生_海青班")
DataFinal<-rbind(Data1,Data2)
total<-NULL
for(i in 1:nrow(DataFinal))
{
total<-c(total,rowSums(DataFinal[i,3:11]))
}
Result<-DataFinal%>%
mutate(人數=total)%>%
group_by(洲別,國別)%>%
summarise(總人數=sum(人數))%>%
arrange(desc(總人數))
Result%>%head(10)
college103 <- read_csv("http://stats.moe.gov.tw/files/detail/103/103_ab103_S.csv")
college104 <- read_csv("http://stats.moe.gov.tw/files/detail/104/104_ab104_S.csv")
college105 <- read_csv("http://stats.moe.gov.tw/files/detail/105/105_ab105_S.csv")
college106 <- read_csv("http://stats.moe.gov.tw/files/detail/106/106_ab105_S.csv")
Data1_1<-rbind(college103,college104)
Data1_2<-rbind(college105,college106)
Data1_2<-Data1_2%>%
rename("學位生-正式修讀學位外國生"="學位生_正式修讀學位外國生",
"學位生-僑生(含港澳)"="學位生_僑生(含港澳)",
"學位生-正式修讀學位陸生"="學位生_正式修讀學位陸生",
"非學位生-外國交換生" ="非學位生_外國交換生",
"非學位生-外國短期研習及個人選讀"="非學位生_外國短期研習及個人選讀",
"非學位生-大專附設華語文中心學生"="非學位生_大專附設華語文中心學生",
"非學位生-大陸研修生"="非學位生_大陸研修生",
"非學位生-海青班"="非學位生_海青班")
DataFinal1<-rbind(Data1_1,Data1_2)
DataFinal1$`非學位生-大陸研修生`<-0
Total<-NULL
for(k in 1:nrow(DataFinal1))
{
Total<-c(Total,rowSums(DataFinal1[k,4:11]))
}
Result2<-DataFinal1%>%
mutate(人數=Total)%>%
group_by(學校名稱)%>%
summarise(總人數=sum(人數))%>%
arrange(desc(總人數))
Result2%>%head(10)
library(ggplot2)
chart1<-ggplot()+
geom_bar(data=Result%>%head(50),
aes(x=國別,y=總人數),
stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
chart1
student <- read.csv("C:/Users/user/Desktop/student.csv", header=FALSE,stringsAsFactors = F)
colnames(student)<-c(student[1,])
student<-student[-1,]
student2<-student%>%
filter(學年度=="103"|學年度=="104")
student2$出國學生人數<-as.numeric(student2$出國學生人數)
Q4_1<-student2%>%
rename(國別=對方學校國別)%>%
group_by(國別)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
Q4_1%>%head(10)
Q4_2<-student2%>%
group_by(學校名稱)%>%
summarise(學生人數=sum(出國學生人數))%>%
arrange(desc(學生人數))
Q4_2%>%head(10)
library(ggplot2)
chart5<-ggplot()+
geom_bar(data=Q4_1,
aes(x=對方學校國別,y=學生人數),
stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
chart5
chart5<-ggplot()+
geom_bar(data=Q4_1,
aes(x=國別,y=學生人數),
stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
library(readr)
X105 <- read_csv("C:/Users/user/Downloads/105.csv")
X105<-X105[,-(4:6)]
Data7<-X105%>%arrange(desc(總人數))
library(ggplot2)
ggplot(Result%>%head(10),aes(x=國別,y=總人數))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
Compare<-data.frame(來台國家=Result$國別,
來台學生=Result$總人數,
留學國家=Q4_1$對方學校國別,
留學人數=Q4_1$學生人數,StringAsFactor=F)
compare<-full_join(Result,Q4_1,by="國別")
compare<-compare%>%
rename("來台學生人數"=總人數,
"留學人數"=學生人數)
world <- map_data("world")
world
gg <- ggplot()
gg <- gg + geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="white", fill="#7f7f7f", size=0.05, alpha=1/4)
gg
gg <- gg + geom_point(data=dat,
aes(x=Lon3, y=Lat3, color=Nation),
size=0.15, alpha=1/100)
gg <- ggplot()+
geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="white", fill="#7f7f7f", size=0.05, alpha=1/4)+
theme_bw()
View(world)
gg <- ggplot()+
geom_map(data=world, map=world,
aes(x=long, y=lat),
color="white", fill="#7f7f7f", size=0.05, alpha=1/4)+
theme_bw()
gg <- ggplot()+
geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="white", fill="#7f7f7f", size=0.05, alpha=1/4)+
theme_bw()
world <- world[world$region != "Antarctica",]
gg <- ggplot()+
geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="white", fill="#7f7f7f", size=0.05, alpha=1/4)+
theme_bw()
gg <- ggplot()+
geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="white", fill="black", size=0.05, alpha=1/4)+
theme_bw()
gg
gg <- ggplot()+
geom_map(data=world, map=world,
aes(x=long, y=lat, map_id=region),
color="black", fill="black", size=0.05, alpha=1/4)+
theme_bw()
gg
View(Result)
world <- map_data("world")
chart1
chart1<-ggplot()+
geom_bar(data=Result%>%head(50),
aes(x=國別),
stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
chart1
chart1<-ggplot()+
geom_bar(data=Result%>%head(50),
aes(x=國別,y=總人數),
stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
chart1
chart1<-ggplot()+
geom_bar(data=Result%>%head(30),
aes(x=國別,y=總人數),
stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
chart1
chart1<-ggplot()+
geom_bar(data=Result%>%head(30),
aes(x=國別,y=總人數),
stat="identity")+
theme(axis.text.x = element_text(angle = -90, hjust = 1,vjust = 0.5))
chart1
chart1<-ggplot()+
geom_bar(data=Result%>%head(30),
aes(x=國別,y=總人數),
stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 0.5,vjust = 0.5))
chart1
chart1<-ggplot()+
geom_bar(data=Result%>%head(30),
aes(x=國別,y=總人數),
stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
chart1
gg
worldmap<-ggmap(gg)+
geom_point(data=Result)
View(compare)
